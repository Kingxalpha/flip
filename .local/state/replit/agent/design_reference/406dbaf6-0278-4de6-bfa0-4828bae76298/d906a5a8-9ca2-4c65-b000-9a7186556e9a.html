<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SolFlip - Provably Fair Coinflip on Solana</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'stake-blue': '#1a1f3a',
                        'stake-dark': '#0f1419',
                        'coin-orange': '#ff6b35',
                        'coin-blue': '#4dabf7',
                        'neon-green': '#51cf66',
                        'neon-red': '#ff6b6b',
                        'text-gray': '#e9ecef'
                    },
                    fontFamily: {
                        'inter': ['Inter', 'sans-serif'],
                        'mono': ['JetBrains Mono', 'monospace']
                    },
                    animation: {
                        'coin-flip': 'coinFlip 1s ease-in-out',
                        'glow': 'glow 2s ease-in-out infinite alternate',
                        'pulse-neon': 'pulseNeon 1.5s ease-in-out infinite'
                    }
                }
            }
        };
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @keyframes coinFlip {
            0% { transform: rotateY(0deg) scale(1); }
            50% { transform: rotateY(180deg) scale(1.1); }
            100% { transform: rotateY(360deg) scale(1); }
        }
        @keyframes glow {
            from { box-shadow: 0 0 20px rgba(81, 207, 102, 0.5); }
            to { box-shadow: 0 0 30px rgba(81, 207, 102, 0.8), 0 0 40px rgba(81, 207, 102, 0.3); }
        }
        @keyframes pulseNeon {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        .coin-shadow {
            filter: drop-shadow(0 10px 20px rgba(0, 0, 0, 0.5));
        }
        .neon-border {
            border: 2px solid transparent;
            background: linear-gradient(45deg, #ff6b35, #4dabf7) border-box;
            -webkit-mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: exclude;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-stake-dark via-stake-blue to-stake-dark min-h-screen font-inter text-white">
    
    <!-- @COMPONENT: Header -->
    <header class="border-b border-gray-700 bg-stake-dark/80 backdrop-blur-sm sticky top-0 z-50">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <div class="w-10 h-10 bg-gradient-to-r from-coin-orange to-coin-blue rounded-lg flex items-center justify-center">
                    <i class="fas fa-coins text-white text-xl"></i>
                </div>
                <h1 class="text-2xl font-bold bg-gradient-to-r from-coin-orange to-coin-blue bg-clip-text text-transparent">
                    SolFlip
                </h1>
                <span class="text-xs bg-neon-green/20 text-neon-green px-2 py-1 rounded-full">Provably Fair</span>
            </div>
            
            <!-- @COMPONENT: WalletConnection -->
            <div class="flex items-center space-x-4">
                <div data-mock="true" class="hidden md:flex items-center space-x-3 bg-stake-blue/50 px-4 py-2 rounded-lg">
                    <img src="https://phantom.app/img/phantom-logo.png" alt="Phantom Wallet" class="w-6 h-6">
                    <span class="text-sm text-text-gray">Balance:</span>
                    <span class="font-mono font-semibold" data-bind="walletBalance">2.45 SOL</span>
                </div>
                <button 
                    class="bg-gradient-to-r from-coin-orange to-coin-blue px-6 py-2 rounded-lg font-semibold hover:scale-105 transition-all duration-200 flex items-center space-x-2"
                    data-event="click:connectWallet"
                    data-implementation="Connect to Phantom wallet using @phantom/browser-sdk">
                    <i class="fas fa-wallet"></i>
                    <span data-mock="true">Connect Phantom</span>
                </button>
            </div>
        </div>
    </header>
    <!-- @END_COMPONENT: Header -->

    <main class="container mx-auto px-4 py-8">
        <div class="grid lg:grid-cols-3 gap-8">
            
            <!-- @COMPONENT: GameInterface -->
            <div class="lg:col-span-2">
                <!-- Game Stats Bar -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
                    <div class="bg-stake-blue/30 backdrop-blur-sm rounded-xl p-4 border border-gray-700">
                        <div class="text-text-gray text-sm mb-1">Current Streak</div>
                        <div class="text-2xl font-bold text-neon-green" data-bind="currentStreak" data-mock="true">7</div>
                    </div>
                    <div class="bg-stake-blue/30 backdrop-blur-sm rounded-xl p-4 border border-gray-700">
                        <div class="text-text-gray text-sm mb-1">Multiplier</div>
                        <div class="text-2xl font-bold text-coin-orange" data-bind="currentMultiplier" data-mock="true">2.56×</div>
                    </div>
                    <div class="bg-stake-blue/30 backdrop-blur-sm rounded-xl p-4 border border-gray-700">
                        <div class="text-text-gray text-sm mb-1">Max Win</div>
                        <div class="text-2xl font-bold text-coin-blue" data-mock="true">1,027,604×</div>
                    </div>
                    <div class="bg-stake-blue/30 backdrop-blur-sm rounded-xl p-4 border border-gray-700">
                        <div class="text-text-gray text-sm mb-1">House Edge</div>
                        <div class="text-2xl font-bold text-text-gray" data-mock="true">2.00%</div>
                    </div>
                </div>

                <!-- Main Game Area -->
                <div class="bg-gradient-to-br from-stake-blue/40 to-stake-dark/60 backdrop-blur-sm rounded-2xl p-8 border border-gray-700 relative overflow-hidden">
                    <!-- Background Pattern -->
                    <div class="absolute inset-0 opacity-5">
                        <div class="w-full h-full" style="background-image: radial-gradient(circle, #ff6b35 1px, transparent 1px); background-size: 20px 20px;"></div>
                    </div>
                    
                    <div class="relative z-10">
                        <!-- Coin Display Area -->
                        <div class="flex justify-center mb-8">
                            <div class="relative">
                                <!-- @FUNCTIONALITY: This coin should implement 3D flip animation using CSS transforms and JavaScript -->
                                <div 
                                    class="w-32 h-32 md:w-40 md:h-40 rounded-full coin-shadow cursor-pointer transition-all duration-300 hover:scale-110"
                                    data-coin-side="heads"
                                    data-event="click:flipCoin"
                                    data-implementation="Trigger coin flip animation and VRF verification">
                                    <!-- Heads Side -->
                                    <div class="w-full h-full rounded-full bg-gradient-to-br from-coin-orange to-orange-600 flex items-center justify-center relative">
                                        <div class="w-16 h-16 md:w-20 md:h-20 rounded-full border-4 border-white/30 flex items-center justify-center">
                                            <i class="fas fa-circle text-white text-2xl md:text-3xl"></i>
                                        </div>
                                        <div class="absolute -top-2 -right-2 w-6 h-6 bg-neon-green rounded-full animate-pulse-neon" data-mock="true" title="Last Result: Heads"></div>
                                    </div>
                                </div>
                                
                                <!-- Flip Animation Overlay -->
                                <div class="absolute inset-0 pointer-events-none">
                                    <div class="w-full h-full rounded-full bg-gradient-to-r from-coin-orange via-white to-coin-blue opacity-0 animate-coin-flip" data-flip-animation="true"></div>
                                </div>
                            </div>
                        </div>

                        <!-- Side Selection -->
                        <div class="grid grid-cols-2 gap-4 mb-6">
                            <button 
                                class="bg-gradient-to-r from-coin-orange to-orange-600 p-4 rounded-xl font-semibold text-lg hover:scale-105 transition-all duration-200 border-2 border-transparent hover:border-white/30"
                                data-event="click:selectHeads"
                                data-selected="true">
                                <i class="fas fa-circle mr-2"></i>
                                Heads
                            </button>
                            <button 
                                class="bg-gradient-to-r from-coin-blue to-blue-600 p-4 rounded-xl font-semibold text-lg hover:scale-105 transition-all duration-200 border-2 border-transparent hover:border-white/30"
                                data-event="click:selectTails">
                                <i class="fas fa-diamond mr-2"></i>
                                Tails
                            </button>
                        </div>

                        <!-- Bet Controls -->
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-text-gray mb-2">Bet Amount (SOL)</label>
                                <div class="relative">
                                    <input 
                                        type="number" 
                                        placeholder="0.1"
                                        step="0.01"
                                        min="0.01"
                                        class="w-full bg-stake-dark/60 border border-gray-600 rounded-lg px-4 py-3 text-white font-mono text-lg focus:border-coin-orange focus:ring-2 focus:ring-coin-orange/20 outline-none"
                                        data-bind="betAmount"
                                        data-mock="true"
                                        value="0.1">
                                    <div class="absolute right-3 top-1/2 -translate-y-1/2 text-text-gray">
                                        SOL
                                    </div>
                                </div>
                                <!-- Quick Bet Buttons -->
                                <div class="flex space-x-2 mt-2">
                                    <button class="px-3 py-1 bg-stake-blue/60 rounded text-sm hover:bg-stake-blue" data-event="click:setBetAmount" data-amount="0.01">0.01</button>
                                    <button class="px-3 py-1 bg-stake-blue/60 rounded text-sm hover:bg-stake-blue" data-event="click:setBetAmount" data-amount="0.1">0.1</button>
                                    <button class="px-3 py-1 bg-stake-blue/60 rounded text-sm hover:bg-stake-blue" data-event="click:setBetAmount" data-amount="0.5">0.5</button>
                                    <button class="px-3 py-1 bg-stake-blue/60 rounded text-sm hover:bg-stake-blue" data-event="click:setBetAmount" data-amount="1">1.0</button>
                                    <button class="px-3 py-1 bg-stake-blue/60 rounded text-sm hover:bg-stake-blue" data-event="click:maxBet">MAX</button>
                                </div>
                            </div>

                            <!-- Flip Button -->
                            <button 
                                class="w-full bg-gradient-to-r from-neon-green to-green-500 py-4 rounded-xl font-bold text-lg hover:scale-105 transition-all duration-200 animate-glow"
                                data-event="click:placeBet"
                                data-implementation="Sign transaction with Phantom wallet and submit to Solana blockchain">
                                <i class="fas fa-bolt mr-2"></i>
                                FLIP COIN
                            </button>

                            <!-- Game Mode Toggle -->
                            <div class="flex bg-stake-dark/60 rounded-lg p-1">
                                <button class="flex-1 py-2 px-4 rounded-md bg-coin-orange text-white font-semibold" data-mode="manual">
                                    Manual
                                </button>
                                <button class="flex-1 py-2 px-4 rounded-md text-text-gray hover:bg-stake-blue/50" data-mode="auto" data-event="click:showAutoSettings">
                                    Auto
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- @END_COMPONENT: GameInterface -->

            <!-- @COMPONENT: Sidebar -->
            <div class="space-y-6">
                
                <!-- VRF Verification Panel -->
                <div class="bg-stake-blue/30 backdrop-blur-sm rounded-xl p-6 border border-gray-700">
                    <h3 class="text-lg font-semibold mb-4 flex items-center">
                        <i class="fas fa-shield-alt text-neon-green mr-2"></i>
                        Provably Fair VRF
                    </h3>
                    <div class="space-y-3 text-sm">
                        <div>
                            <span class="text-text-gray">Last Proof:</span>
                            <div class="font-mono bg-stake-dark/60 p-2 rounded mt-1 break-all text-xs" data-mock="true" data-bind="vrfProof">
                                3k8f9j2h...x7v9m1q4
                            </div>
                        </div>
                        <div>
                            <span class="text-text-gray">Seed:</span>
                            <div class="font-mono bg-stake-dark/60 p-2 rounded mt-1 break-all text-xs" data-mock="true" data-bind="gameSeed">
                                a2b8c9d1...e5f6g7h8
                            </div>
                        </div>
                        <button class="w-full bg-neon-green/20 text-neon-green border border-neon-green/30 py-2 rounded hover:bg-neon-green/30 transition-colors" data-event="click:verifyProof">
                            <i class="fas fa-check-circle mr-2"></i>
                            Verify Proof
                        </button>
                    </div>
                </div>

                <!-- Auto Settings Panel (Hidden by default) -->
                <div class="bg-stake-blue/30 backdrop-blur-sm rounded-xl p-6 border border-gray-700 hidden" data-component="autoSettings">
                    <h3 class="text-lg font-semibold mb-4">Auto Settings</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm text-text-gray mb-2">Number of Flips</label>
                            <input type="number" min="1" max="100" value="10" class="w-full bg-stake-dark/60 border border-gray-600 rounded px-3 py-2">
                        </div>
                        <div>
                            <label class="block text-sm text-text-gray mb-2">Stop on Loss</label>
                            <input type="checkbox" class="mr-2">
                            <span class="text-sm">Enabled</span>
                        </div>
                        <div>
                            <label class="block text-sm text-text-gray mb-2">Stop on Win Amount</label>
                            <input type="number" step="0.01" placeholder="5.0" class="w-full bg-stake-dark/60 border border-gray-600 rounded px-3 py-2">
                        </div>
                        <button class="w-full bg-coin-blue py-2 rounded font-semibold">Start Auto</button>
                    </div>
                </div>

                <!-- Game History -->
                <div class="bg-stake-blue/30 backdrop-blur-sm rounded-xl p-6 border border-gray-700">
                    <h3 class="text-lg font-semibold mb-4 flex items-center">
                        <i class="fas fa-history mr-2"></i>
                        Recent Flips
                    </h3>
                    <div class="space-y-2">
                        <!-- @MAP: gameHistory.map(game => ( -->
                        <div class="flex justify-between items-center p-3 bg-stake-dark/40 rounded-lg" data-mock="true">
                            <div class="flex items-center space-x-3">
                                <div class="w-6 h-6 rounded-full bg-coin-orange flex items-center justify-center">
                                    <i class="fas fa-circle text-white text-xs"></i>
                                </div>
                                <span class="text-sm text-text-gray">Heads</span>
                            </div>
                            <div class="text-right">
                                <div class="text-neon-green font-semibold">+0.15 SOL</div>
                                <div class="text-xs text-text-gray">2.5×</div>
                            </div>
                        </div>
                        <div class="flex justify-between items-center p-3 bg-stake-dark/40 rounded-lg" data-mock="true">
                            <div class="flex items-center space-x-3">
                                <div class="w-6 h-6 rounded-full bg-coin-blue flex items-center justify-center">
                                    <i class="fas fa-diamond text-white text-xs"></i>
                                </div>
                                <span class="text-sm text-text-gray">Tails</span>
                            </div>
                            <div class="text-right">
                                <div class="text-neon-red font-semibold">-0.1 SOL</div>
                                <div class="text-xs text-text-gray">0×</div>
                            </div>
                        </div>
                        <div class="flex justify-between items-center p-3 bg-stake-dark/40 rounded-lg" data-mock="true">
                            <div class="flex items-center space-x-3">
                                <div class="w-6 h-6 rounded-full bg-coin-orange flex items-center justify-center">
                                    <i class="fas fa-circle text-white text-xs"></i>
                                </div>
                                <span class="text-sm text-text-gray">Heads</span>
                            </div>
                            <div class="text-right">
                                <div class="text-neon-green font-semibold">+0.2 SOL</div>
                                <div class="text-xs text-text-gray">2.0×</div>
                            </div>
                        </div>
                        <!-- @END_MAP )) -->
                    </div>
                    <button class="w-full mt-4 text-coin-blue hover:text-coin-orange transition-colors text-sm" data-event="click:showAllHistory">
                        View All History →
                    </button>
                </div>

                <!-- Leaderboard -->
                <div class="bg-stake-blue/30 backdrop-blur-sm rounded-xl p-6 border border-gray-700">
                    <h3 class="text-lg font-semibold mb-4 flex items-center">
                        <i class="fas fa-trophy text-yellow-500 mr-2"></i>
                        Top Winners Today
                    </h3>
                    <div class="space-y-3">
                        <!-- @MAP: leaderboard.map((player, index) => ( -->
                        <div class="flex justify-between items-center" data-mock="true">
                            <div class="flex items-center space-x-3">
                                <div class="w-8 h-8 bg-gradient-to-r from-yellow-500 to-orange-500 rounded-full flex items-center justify-center text-sm font-bold">
                                    1
                                </div>
                                <span class="text-sm font-mono">crypto**king</span>
                            </div>
                            <span class="text-neon-green font-semibold">+127.5 SOL</span>
                        </div>
                        <div class="flex justify-between items-center" data-mock="true">
                            <div class="flex items-center space-x-3">
                                <div class="w-8 h-8 bg-gradient-to-r from-gray-400 to-gray-600 rounded-full flex items-center justify-center text-sm font-bold">
                                    2
                                </div>
                                <span class="text-sm font-mono">flip**master</span>
                            </div>
                            <span class="text-neon-green font-semibold">+89.2 SOL</span>
                        </div>
                        <div class="flex justify-between items-center" data-mock="true">
                            <div class="flex items-center space-x-3">
                                <div class="w-8 h-8 bg-gradient-to-r from-orange-600 to-red-600 rounded-full flex items-center justify-center text-sm font-bold">
                                    3
                                </div>
                                <span class="text-sm font-mono">lucky**7</span>
                            </div>
                            <span class="text-neon-green font-semibold">+45.8 SOL</span>
                        </div>
                        <!-- @END_MAP )) -->
                    </div>
                </div>
            </div>
            <!-- @END_COMPONENT: Sidebar -->
        </div>
    </main>

    <!-- @COMPONENT: FloatingNotifications -->
    <div class="fixed bottom-4 right-4 space-y-2 z-50" data-component="notifications">
        <!-- Success notification example -->
        <div class="bg-neon-green/20 border border-neon-green/50 text-neon-green p-4 rounded-lg backdrop-blur-sm hidden" data-notification-type="success">
            <div class="flex items-center space-x-2">
                <i class="fas fa-check-circle"></i>
                <span data-mock="true">Transaction confirmed! You won 0.2 SOL</span>
            </div>
        </div>
        <!-- Error notification example -->
        <div class="bg-neon-red/20 border border-neon-red/50 text-neon-red p-4 rounded-lg backdrop-blur-sm hidden" data-notification-type="error">
            <div class="flex items-center space-x-2">
                <i class="fas fa-exclamation-circle"></i>
                <span data-mock="true">Transaction failed. Please try again.</span>
            </div>
        </div>
    </div>
    <!-- @END_COMPONENT: FloatingNotifications -->

    <!-- @COMPONENT: LoadingOverlay -->
    <div class="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 hidden" data-component="loadingOverlay">
        <div class="bg-stake-blue/90 p-8 rounded-xl border border-gray-700 text-center">
            <div class="w-16 h-16 border-4 border-coin-orange border-t-transparent rounded-full animate-spin mx-auto mb-4"></div>
            <h3 class="text-xl font-semibold mb-2">Processing Transaction</h3>
            <p class="text-text-gray" data-mock="true">Signing with Phantom wallet...</p>
        </div>
    </div>
    <!-- @END_COMPONENT: LoadingOverlay -->

    <script>
        // TODO: Implement Phantom wallet integration using @phantom/browser-sdk
        // TODO: Implement Solana Web3.js for blockchain interactions
        // TODO: Implement VRF proof verification
        // TODO: Implement real-time game state management
        
        (function() {
            // Encapsulated game state and functionality
            const gameState = {
                isConnected: false,
                currentBet: 0.1,
                selectedSide: 'heads',
                isFlipping: false,
                streak: 0,
                multiplier: 1.0
            };

            // Mock wallet connection status
            const walletButton = document.querySelector('[data-event="click:connectWallet"]');
            const balanceDisplay = document.querySelector('[data-bind="walletBalance"]');
            
            // Game mode switching
            const manualBtn = document.querySelector('[data-mode="manual"]');
            const autoBtn = document.querySelector('[data-mode="auto"]');
            const autoSettings = document.querySelector('[data-component="autoSettings"]');

            // Side selection
            const headsBtn = document.querySelector('[data-event="click:selectHeads"]');
            const tailsBtn = document.querySelector('[data-event="click:selectTails"]');

            // Bet amount controls
            const betInput = document.querySelector('[data-bind="betAmount"]');
            const quickBetButtons = document.querySelectorAll('[data-event="click:setBetAmount"]');

            // Flip button
            const flipButton = document.querySelector('[data-event="click:placeBet"]');

            // Initialize event listeners
            function initializeEventListeners() {
                // Wallet connection
                walletButton?.addEventListener('click', () => {
                    showLoadingOverlay('Connecting to Phantom wallet...');
                    // TODO: Implement actual Phantom wallet connection
                    setTimeout(() => {
                        hideLoadingOverlay();
                        gameState.isConnected = true;
                        walletButton.innerHTML = '<i class="fas fa-wallet"></i><span>Connected</span>';
                        walletButton.classList.remove('from-coin-orange', 'to-coin-blue');
                        walletButton.classList.add('bg-neon-green');
                        showNotification('success', 'Phantom wallet connected successfully!');
                    }, 2000);
                });

                // Game mode switching
                autoBtn?.addEventListener('click', () => {
                    manualBtn.classList.remove('bg-coin-orange');
                    manualBtn.classList.add('text-text-gray', 'hover:bg-stake-blue/50');
                    autoBtn.classList.add('bg-coin-orange', 'text-white');
                    autoBtn.classList.remove('text-text-gray', 'hover:bg-stake-blue/50');
                    autoSettings?.classList.remove('hidden');
                });

                manualBtn?.addEventListener('click', () => {
                    autoBtn.classList.remove('bg-coin-orange', 'text-white');
                    autoBtn.classList.add('text-text-gray', 'hover:bg-stake-blue/50');
                    manualBtn.classList.add('bg-coin-orange', 'text-white');
                    manualBtn.classList.remove('text-text-gray', 'hover:bg-stake-blue/50');
                    autoSettings?.classList.add('hidden');
                });

                // Side selection
                headsBtn?.addEventListener('click', () => {
                    gameState.selectedSide = 'heads';
                    headsBtn.classList.add('border-white/30');
                    tailsBtn?.classList.remove('border-white/30');
                });

                tailsBtn?.addEventListener('click', () => {
                    gameState.selectedSide = 'tails';
                    tailsBtn.classList.add('border-white/30');
                    headsBtn?.classList.remove('border-white/30');
                });

                // Quick bet buttons
                quickBetButtons.forEach(button => {
                    button.addEventListener('click', () => {
                        const amount = button.dataset.amount;
                        if (amount === 'max') {
                            betInput.value = '2.45'; // Mock max balance
                        } else {
                            betInput.value = amount;
                        }
                        gameState.currentBet = parseFloat(betInput.value);
                    });
                });

                // Bet input
                betInput?.addEventListener('input', (e) => {
                    gameState.currentBet = parseFloat(e.target.value) || 0;
                });

                // Flip button
                flipButton?.addEventListener('click', () => {
                    if (!gameState.isConnected) {
                        showNotification('error', 'Please connect your Phantom wallet first');
                        return;
                    }
                    
                    if (gameState.currentBet <= 0) {
                        showNotification('error', 'Please enter a valid bet amount');
                        return;
                    }

                    performCoinFlip();
                });

                // VRF verification
                const verifyButton = document.querySelector('[data-event="click:verifyProof"]');
                verifyButton?.addEventListener('click', () => {
                    showLoadingOverlay('Verifying VRF proof...');
                    // TODO: Implement actual VRF proof verification
                    setTimeout(() => {
                        hideLoadingOverlay();
                        showNotification('success', 'VRF proof verified successfully!');
                    }, 1500);
                });
            }

            function performCoinFlip() {
                if (gameState.isFlipping) return;
                
                gameState.isFlipping = true;
                flipButton.disabled = true;
                flipButton.innerHTML = '<i class="fas fa-spinner animate-spin mr-2"></i>FLIPPING...';

                // Animate coin flip
                const coin = document.querySelector('[data-coin-side]');
                coin.style.animation = 'coinFlip 1s ease-in-out';

                showLoadingOverlay('Signing transaction with Phantom...');

                // Simulate blockchain transaction and VRF result
                setTimeout(() => {
                    hideLoadingOverlay();
                    
                    // Mock result (50/50 chance)
                    const result = Math.random() < 0.5 ? 'heads' : 'tails';
                    const won = result === gameState.selectedSide;
                    
                    // Update coin display
                    updateCoinDisplay(result);
                    
                    // Update game state
                    if (won) {
                        gameState.streak++;
                        gameState.multiplier = Math.pow(2, gameState.streak);
                        const winAmount = gameState.currentBet * 2;
                        showNotification('success', `You won! +${winAmount.toFixed(3)} SOL (${gameState.multiplier.toFixed(2)}×)`);
                        updateBalance(winAmount);
                    } else {
                        gameState.streak = 0;
                        gameState.multiplier = 1.0;
                        showNotification('error', `You lost! -${gameState.currentBet.toFixed(3)} SOL`);
                        updateBalance(-gameState.currentBet);
                    }
                    
                    // Update displays
                    updateStreakDisplay();
                    updateMultiplierDisplay();
                    addToHistory(result, won, gameState.currentBet);
                    
                    // Reset flip button
                    gameState.isFlipping = false;
                    flipButton.disabled = false;
                    flipButton.innerHTML = '<i class="fas fa-bolt mr-2"></i>FLIP COIN';
                    
                    // Reset coin animation
                    coin.style.animation = '';
                }, 3000);
            }

            function updateCoinDisplay(result) {
                const coin = document.querySelector('[data-coin-side]');
                const indicator = coin.querySelector('.absolute div');
                
                if (result === 'heads') {
                    coin.classList.remove('bg-gradient-to-br', 'from-coin-blue', 'to-blue-600');
                    coin.classList.add('bg-gradient-to-br', 'from-coin-orange', 'to-orange-600');
                    indicator.classList.remove('bg-neon-red');
                    indicator.classList.add('bg-neon-green');
                } else {
                    coin.classList.remove('bg-gradient-to-br', 'from-coin-orange', 'to-orange-600');
                    coin.classList.add('bg-gradient-to-br', 'from-coin-blue', 'to-blue-600');
                    coin.querySelector('i').className = 'fas fa-diamond text-white text-2xl md:text-3xl';
                    indicator.classList.remove('bg-neon-green');
                    indicator.classList.add('bg-neon-red');
                }
            }

            function updateBalance(change) {
                const currentBalance = parseFloat(balanceDisplay?.textContent.split(' ')[0]) || 0;
                const newBalance = Math.max(0, currentBalance + change);
                if (balanceDisplay) {
                    balanceDisplay.textContent = `${newBalance.toFixed(3)} SOL`;
                }
            }

            function updateStreakDisplay() {
                const streakElement = document.querySelector('[data-bind="currentStreak"]');
                if (streakElement) {
                    streakElement.textContent = gameState.streak.toString();
                }
            }

            function updateMultiplierDisplay() {
                const multiplierElement = document.querySelector('[data-bind="currentMultiplier"]');
                if (multiplierElement) {
                    multiplierElement.textContent = `${gameState.multiplier.toFixed(2)}×`;
                }
            }

            function addToHistory(result, won, betAmount) {
                // TODO: Add new entry to game history display
                console.log(`History: ${result}, Won: ${won}, Bet: ${betAmount}`);
            }

            function showLoadingOverlay(message) {
                const overlay = document.querySelector('[data-component="loadingOverlay"]');
                const messageElement = overlay?.querySelector('p');
                if (messageElement) messageElement.textContent = message;
                overlay?.classList.remove('hidden');
            }

            function hideLoadingOverlay() {
                const overlay = document.querySelector('[data-component="loadingOverlay"]');
                overlay?.classList.add('hidden');
            }

            function showNotification(type, message) {
                const notification = document.querySelector(`[data-notification-type="${type}"]`);
                const messageElement = notification?.querySelector('span');
                if (messageElement) messageElement.textContent = message;
                notification?.classList.remove('hidden');
                
                // Auto-hide after 3 seconds
                setTimeout(() => {
                    notification?.classList.add('hidden');
                }, 3000);
            }

            // Initialize the application
            initializeEventListeners();
        })();
    </script>
</body>
</html>